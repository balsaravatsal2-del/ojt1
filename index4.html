<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1280, initial-scale=1.0">
    <title>Saffron & Silk | Enterprise Restaurant Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f5f0;
            min-width: 1200px; /* Force minimum desktop width */
        }
        h1, h2, h3, .font-serif {
            font-family: 'Playfair Display', serif;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #c5a059;
            border-radius: 10px;
        }
        .bg-gold { background-color: #c5a059; }
        .text-gold { color: #c5a059; }
        .border-gold { border-color: #c5a059; }
        .view-hidden { display: none !important; }
        
        /* Toggle Switch Styles */
        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 22px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #444;
            transition: .4s;
            border-radius: 20px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 16px; width: 16px;
            left: 3px; bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: #c5a059; }
        input:checked + .slider:before { transform: translateX(18px); }

        .filter-btn-active {
            background-color: #1c1917 !important;
            color: white !important;
            border-color: #c5a059 !important;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-stone-900 text-white p-5 shadow-2xl flex justify-between items-center border-b-2 border-gold shrink-0 z-50">
        <div class="flex items-center gap-10">
            <div class="text-2xl font-bold tracking-[0.2em] uppercase">Saffron & Silk</div>
            <nav class="flex gap-6">
                <button onclick="switchView('ordering')" id="nav-ordering" class="text-sm text-gold border border-gold px-5 py-2 rounded bg-stone-800 font-semibold tracking-wide transition-all">ORDER ENTRY</button>
                <button onclick="switchView('kitchen')" id="nav-kitchen" class="text-sm text-stone-400 border border-stone-700 px-5 py-2 rounded hover:text-gold transition-all font-semibold tracking-wide">KITCHEN DISPLAY (KDS)</button>
                <button onclick="switchView('manager')" id="nav-manager" class="text-sm text-stone-400 border border-stone-700 px-5 py-2 rounded hover:text-gold transition-all font-semibold tracking-wide">MANAGER CONSOLE</button>
            </nav>
        </div>
        <div class="flex items-center gap-8">
            <div id="tableSelectorContainer" class="flex items-center gap-4 bg-stone-800 px-4 py-2 rounded-lg border border-stone-700">
                <label class="text-xs font-bold text-stone-400 uppercase tracking-widest">Active Table</label>
                <select id="tableSelector" onchange="switchTable(this.value)" class="bg-transparent text-gold font-bold text-lg focus:outline-none cursor-pointer">
                    <option value="1">Table 01</option>
                    <option value="2">Table 02</option>
                    <option value="3">Table 03</option>
                    <option value="4">Table 04</option>
                    <option value="5">Table 05</option>
                    <option value="6">Table 06</option>
                    <option value="7">Table 07</option>
                    <option value="8">Table 08</option>
                </select>
            </div>
        </div>
    </header>

    <!-- CONTENT AREA -->
    <div class="flex-1 relative overflow-hidden flex">
        
        <!-- VIEW 1: ORDER ENTRY -->
        <main id="view-ordering" class="flex-1 flex overflow-hidden">
            <!-- Menu Grid -->
            <section class="flex-1 p-8 overflow-y-auto custom-scrollbar">
                <div class="flex justify-between items-end mb-10 border-b border-stone-300 pb-6">
                    <div>
                        <h2 class="text-4xl font-bold text-stone-800">Cuisine Menu</h2>
                        <p class="text-stone-500 text-sm mt-2">Select items to add to the active table's bill</p>
                    </div>
                    <div class="flex gap-2" id="menuFilters">
                        <button onclick="filterMenu('all')" data-cat="all" class="filter-btn filter-btn-active px-5 py-2 text-xs border border-stone-400 rounded-full hover:bg-stone-800 hover:text-white transition uppercase font-bold tracking-tighter">All Categories</button>
                        <button onclick="filterMenu('starter')" data-cat="starter" class="filter-btn px-5 py-2 text-xs border border-stone-400 rounded-full hover:bg-stone-800 hover:text-white transition uppercase font-bold tracking-tighter">Starters</button>
                        <button onclick="filterMenu('mains')" data-cat="mains" class="filter-btn px-5 py-2 text-xs border border-stone-400 rounded-full hover:bg-stone-800 hover:text-white transition uppercase font-bold tracking-tighter">Main Course</button>
                        <button onclick="filterMenu('beverage')" data-cat="beverage" class="filter-btn px-5 py-2 text-xs border border-stone-400 rounded-full hover:bg-stone-800 hover:text-white transition uppercase font-bold tracking-tighter">Vintages</button>
                        <button onclick="filterMenu('dessert')" data-cat="dessert" class="filter-btn px-5 py-2 text-xs border border-stone-400 rounded-full hover:bg-stone-800 hover:text-white transition uppercase font-bold tracking-tighter">Desserts</button>
                    </div>
                </div>
                <div id="menuGrid" class="grid grid-cols-3 gap-8"></div>
            </section>

            <!-- Order Summary (Sidebar) -->
            <aside class="w-[450px] bg-white border-l border-stone-200 flex flex-col shadow-[-10px_0_30px_rgba(0,0,0,0.05)] z-40">
                <div class="p-8 bg-stone-50 border-b border-stone-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-2xl font-bold text-stone-800 uppercase tracking-tighter">Table <span id="activeTableNum">01</span></h3>
                        <div class="text-[10px] bg-stone-900 text-gold px-3 py-1 rounded-full font-bold uppercase tracking-[0.2em]">Live Bill</div>
                    </div>
                    <p class="text-xs text-stone-500 mt-2 uppercase tracking-widest font-medium">Order Summary & Controls</p>
                </div>
                
                <div id="cartItems" class="flex-1 overflow-y-auto p-8 space-y-4 custom-scrollbar bg-white"></div>
                
                <!-- Pricing & Actions -->
                <div class="p-8 bg-stone-900 text-white shadow-[0_-10px_40px_rgba(0,0,0,0.3)]">
                    <div class="space-y-3 mb-6">
                        <div class="flex justify-between text-sm font-light">
                            <span class="text-stone-400">Subtotal</span>
                            <span id="subtotal" class="font-semibold">₹ 0</span>
                        </div>
                        <div class="flex justify-between text-sm font-light">
                            <span class="text-stone-400">Service Charge (10%) & GST (18%)</span>
                            <span id="taxCombined" class="font-semibold">₹ 0</span>
                        </div>
                        <div class="flex justify-between text-sm font-light">
                            <span class="text-stone-400">Beverage Corkage Fees</span>
                            <span id="corkage" class="font-semibold">₹ 0</span>
                        </div>
                        
                        <div class="flex justify-between items-center text-sm pt-2 border-t border-stone-800">
                            <div class="flex items-center gap-3">
                                <span class="text-stone-300 font-medium">Add Gratuity (5%)</span>
                                <label class="switch">
                                    <input type="checkbox" id="gratuityToggle" onchange="toggleGratuity()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <span id="tip" class="font-bold text-gold">₹ 0</span>
                        </div>

                        <div class="flex justify-between text-gold font-bold text-3xl pt-4 mt-4 border-t border-stone-700">
                            <span class="font-serif">Total Due</span>
                            <span id="grandTotal">₹ 0</span>
                        </div>
                    </div>
                    
                    <button onclick="placeOrder()" class="w-full bg-gold hover:bg-[#b58e4a] text-stone-900 font-bold py-4 rounded-lg transition-all transform active:scale-[0.98] uppercase tracking-[0.2em] text-sm shadow-lg">
                        Send to Kitchen
                    </button>
                </div>
            </aside>
        </main>

        <!-- VIEW 2: KITCHEN DISPLAY SYSTEM -->
        <main id="view-kitchen" class="w-full p-10 overflow-y-auto custom-scrollbar view-hidden bg-[#f8f5f0]">
            <div class="max-w-[1600px] mx-auto">
                <div class="flex justify-between items-center mb-10 border-b-2 border-stone-300 pb-6">
                    <div>
                        <h2 class="text-4xl font-bold text-stone-800">Kitchen Display System</h2>
                        <p class="text-stone-500 mt-2">Real-time order tracking and fulfillment</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="flex items-center gap-2">
                            <span class="w-3 h-3 bg-gold rounded-full animate-pulse"></span>
                            <span class="text-xs font-bold text-stone-600 uppercase tracking-widest">Live Updates Enabled</span>
                        </div>
                    </div>
                </div>
                <div id="kitchenOrdersGrid" class="grid grid-cols-4 gap-8"></div>
            </div>
        </main>

        <!-- VIEW 3: MANAGER DASHBOARD -->
        <main id="view-manager" class="w-full p-10 overflow-y-auto custom-scrollbar view-hidden bg-[#f8f5f0]">
            <div class="max-w-[1600px] mx-auto">
                <div class="flex justify-between items-center mb-10 border-b-2 border-stone-300 pb-8">
                    <div>
                        <h2 class="text-4xl font-bold text-stone-800">Management Dashboard</h2>
                        <p class="text-stone-500 mt-2">Table occupancy and financial performance</p>
                    </div>
                    <div class="bg-stone-900 text-white px-10 py-5 rounded-2xl shadow-2xl border-l-[6px] border-gold flex flex-col items-end">
                        <p class="text-xs text-gold uppercase tracking-[0.3em] font-bold mb-2">Total Combined Revenue</p>
                        <p id="totalRevenue" class="text-5xl font-bold tracking-tighter">₹ 0</p>
                    </div>
                </div>
                <div class="grid grid-cols-4 gap-8" id="managerTableGrid"></div>
            </div>
        </main>
    </div>

    <!-- System Toast -->
    <div id="toast" class="fixed bottom-12 left-1/2 -translate-x-1/2 bg-stone-900 text-white px-10 py-6 rounded-2xl shadow-[0_20px_60px_rgba(0,0,0,0.4)] opacity-0 transition-all duration-500 pointer-events-none flex flex-col items-center gap-4 z-[100] border border-stone-700 min-w-[400px]">
        <div class="flex items-center gap-4 w-full justify-center">
            <div class="w-10 h-10 bg-gold rounded-full flex items-center justify-center">
                <svg class="w-6 h-6 text-stone-900" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
            </div>
            <div class="flex flex-col">
                <span class="text-gold font-bold text-xs uppercase tracking-widest">System Notification</span>
                <span id="toastMsg" class="text-lg font-semibold"></span>
            </div>
        </div>
        <div id="toastAction" class="view-hidden w-full border-t border-stone-800 pt-4 mt-2">
            <button onclick="switchView('kitchen')" class="w-full text-sm bg-stone-800 text-gold border border-gold px-6 py-2 rounded-lg hover:bg-gold hover:text-stone-900 transition-all font-bold uppercase tracking-widest">View in Kitchen Display</button>
        </div>
    </div>

    <script>
        const menuItems = [
            { id: 1, name: "Hara Bhara Kebab", category: "starter", price: 350, desc: "Classic spinach, green pea and potato patties spiced with house blend." },
            { id: 2, name: "Paneer Tikka Angare", category: "starter", price: 420, desc: "Smoky tandoor-grilled cottage cheese marinated in Kashmiri chili." },
            { id: 3, name: "Chicken Seekh Gilafi", category: "starter", price: 480, desc: "Minced chicken skewers coated with bell peppers and onions." },
            { id: 11, name: "Tandoori Jhinga", category: "starter", price: 750, desc: "Jumbo prawns marinated in yellow chili and yogurt marinade." },
            
            { id: 4, name: "Dal Saffron & Silk", category: "mains", price: 450, desc: "Our signature 24-hour slow-cooked black lentils with white butter." },
            { id: 5, name: "Old Delhi Butter Chicken", category: "mains", price: 580, desc: "Tandoori chicken pulled and cooked in a rich, velvet tomato gravy." },
            { id: 6, name: "Kadai Paneer Peshawari", category: "mains", price: 480, desc: "Cottage cheese wok-tossed with crushed spices and peppers." },
            { id: 7, name: "Nalli Rogan Josh", category: "mains", price: 650, desc: "Prime lamb shanks slow-braised in a traditional aromatic gravy." },
            
            { id: 14, name: "Sula Shiraz (Glass)", category: "beverage", price: 450, desc: "Medium-bodied red wine with notes of pepper and mocha." },
            { id: 16, name: "Signature Old Fashioned", category: "beverage", price: 550, desc: "House-infused bourbon, orange bitters, and smoked cinnamon." },
            { id: 18, name: "Artisanal Gin & Tonic", category: "beverage", price: 480, desc: "Premium craft gin, elderflower tonic, and botanical garnish." },

            { id: 9, name: "Classic Gulab Jamun", category: "dessert", price: 180, desc: "Warm reduced milk dumplings in a saffron-infused sugar syrup." },
            { id: 10, name: "Alphonso Mango Kulfi", category: "dessert", price: 220, desc: "Traditional slow-churned frozen dessert with fresh mango pulp." },
            { id: 21, name: "Rose & Nut Baklava", category: "dessert", price: 340, desc: "Imported filo layers with pistachios and organic honey syrup." }
        ];

        let tableOrders = { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [] };
        let tableGratuitySettings = { 1: false, 2: false, 3: false, 4: false, 5: false, 6: false, 7: false, 8: false };
        let kitchenOrders = [];
        let currentTableId = 1;
        const CORKAGE_PER_BEV = 150; 

        function init() {
            renderMenu('all');
            updateCartDisplay();
        }

        function switchView(view) {
            document.getElementById('view-ordering').classList.add('view-hidden');
            document.getElementById('view-kitchen').classList.add('view-hidden');
            document.getElementById('view-manager').classList.add('view-hidden');
            
            const tableSelector = document.getElementById('tableSelectorContainer');
            if(view === 'ordering') {
                tableSelector.classList.remove('invisible');
            } else {
                tableSelector.classList.add('invisible');
            }
            
            ['ordering', 'kitchen', 'manager'].forEach(v => {
                const btn = document.getElementById(`nav-${v}`);
                if(btn) {
                    if(v === view) {
                        btn.className = "text-sm text-gold border border-gold px-5 py-2 rounded bg-stone-800 font-bold tracking-wide";
                    } else {
                        btn.className = "text-sm text-stone-400 border border-stone-700 px-5 py-2 rounded hover:text-gold transition-all font-semibold tracking-wide";
                    }
                }
            });

            document.getElementById(`view-${view}`).classList.remove('view-hidden');
            if (view === 'ordering') updateCartDisplay();
            else if (view === 'kitchen') renderKitchen();
            else if (view === 'manager') renderManager();
        }

        function renderMenu(filter) {
            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => {
                btn.classList.toggle('filter-btn-active', btn.getAttribute('data-cat') === filter);
            });

            const grid = document.getElementById('menuGrid');
            grid.innerHTML = '';
            const filtered = filter === 'all' ? menuItems : menuItems.filter(item => item.category === filter);
            filtered.forEach(item => {
                grid.innerHTML += `
                    <div class="bg-white p-6 rounded-2xl border border-stone-200 hover:border-gold transition-all group cursor-pointer shadow-sm hover:shadow-xl relative overflow-hidden" onclick="addToCart(${item.id})">
                        <div class="flex justify-between items-start mb-2 relative z-10">
                            <h4 class="font-bold text-lg text-stone-800 group-hover:text-gold transition-colors">${item.name}</h4>
                            <span class="text-stone-900 font-bold text-lg">₹${item.price}</span>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed mb-6 relative z-10 h-12 overflow-hidden">${item.desc}</p>
                        <div class="text-[10px] font-bold text-gold uppercase tracking-[0.2em] relative z-10 flex items-center gap-2">
                            <span class="w-6 h-[2px] bg-gold"></span> Add to Bill
                        </div>
                        <div class="absolute bottom-0 right-0 opacity-[0.03] text-stone-900 group-hover:scale-110 transition-transform -mb-4 -mr-4">
                             <svg class="w-32 h-32" fill="currentColor" viewBox="0 0 24 24"><path d="M11 9H9V2H7V9H5V2H3V9C3 11.12 4.66 12.84 6.75 12.97V22H9.25V12.97C11.34 12.84 13 11.12 13 9V2H11V9ZM16 6V14H18.5V22H21V2C18.24 2 16 4.24 16 6Z"/></svg>
                        </div>
                    </div>`;
            });
        }

        function filterMenu(cat) { renderMenu(cat); }

        function switchTable(id) {
            currentTableId = parseInt(id);
            document.getElementById('activeTableNum').innerText = id.padStart(2, '0');
            document.getElementById('tableSelector').value = id;
            document.getElementById('gratuityToggle').checked = tableGratuitySettings[currentTableId];
            updateCartDisplay();
        }

        function toggleGratuity() {
            tableGratuitySettings[currentTableId] = document.getElementById('gratuityToggle').checked;
            updateCartDisplay();
        }

        function addToCart(itemId) {
            const item = menuItems.find(i => i.id === itemId);
            const tableCart = tableOrders[currentTableId];
            const existing = tableCart.find(i => i.id === itemId && !i.sentToKitchen);
            if (existing) existing.quantity++;
            else tableCart.push({ ...item, quantity: 1, sentToKitchen: false });
            updateCartDisplay();
        }

        function updateQuantity(itemId, delta) {
            const tableCart = tableOrders[currentTableId];
            const index = tableCart.findIndex(i => i.id === itemId && !i.sentToKitchen);
            if (index !== -1) {
                tableCart[index].quantity += delta;
                if (tableCart[index].quantity <= 0) tableCart.splice(index, 1);
            }
            updateCartDisplay();
        }

        function updateCartDisplay() {
            const cartContainer = document.getElementById('cartItems');
            const tableCart = tableOrders[currentTableId];
            
            if (tableCart.length === 0) {
                cartContainer.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full text-stone-400 space-y-4">
                        <svg class="w-16 h-16 opacity-20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                        <p class="text-sm font-bold uppercase tracking-[0.3em] text-center">No Active Items</p>
                    </div>`;
            } else {
                cartContainer.innerHTML = tableCart.map(item => `
                    <div class="flex justify-between items-center ${item.sentToKitchen ? 'opacity-40 grayscale-[50%]' : 'bg-stone-50 shadow-sm'} p-4 rounded-xl border border-stone-100 transition-all">
                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <div class="font-bold text-stone-900 text-sm uppercase tracking-wide">${item.name}</div>
                                ${item.sentToKitchen ? '<span class="text-[8px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold">KITCHEN READY</span>' : ''}
                            </div>
                            <div class="text-xs text-stone-500 mt-1 font-medium">₹${item.price} per unit</div>
                        </div>
                        <div class="flex items-center gap-4">
                            ${!item.sentToKitchen ? `
                                <div class="flex items-center bg-white rounded-lg border border-stone-200 overflow-hidden shadow-inner">
                                    <button onclick="updateQuantity(${item.id}, -1)" class="w-10 h-10 flex items-center justify-center hover:bg-red-50 text-stone-400 hover:text-red-500 transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M20 12H4"></path></svg>
                                    </button>
                                    <span class="w-8 text-center text-sm font-bold text-stone-800">${item.quantity}</span>
                                    <button onclick="updateQuantity(${item.id}, 1)" class="w-10 h-10 flex items-center justify-center hover:bg-green-50 text-stone-400 hover:text-green-500 transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 4v16m8-8H4"></path></svg>
                                    </button>
                                </div>
                            ` : `
                                <div class="flex items-center gap-2 bg-stone-100 px-4 py-2 rounded-lg border border-stone-200">
                                    <span class="text-xs text-stone-400 font-bold">QTY</span>
                                    <span class="text-sm font-bold text-stone-800">${item.quantity}</span>
                                </div>
                            `}
                        </div>
                    </div>`).join('');
            }

            const billing = calculateBill(currentTableId);
            document.getElementById('subtotal').innerText = `₹ ${billing.subtotal.toLocaleString('en-IN')}`;
            document.getElementById('taxCombined').innerText = `₹ ${(billing.tax + billing.serviceCharge).toLocaleString('en-IN')}`;
            document.getElementById('corkage').innerText = `₹ ${billing.corkage.toLocaleString('en-IN')}`;
            document.getElementById('tip').innerText = `₹ ${billing.tip.toLocaleString('en-IN')}`;
            document.getElementById('grandTotal').innerText = `₹ ${billing.total.toLocaleString('en-IN')}`;
        }

        function calculateBill(tableId) {
            const cart = tableOrders[tableId] || [];
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            if (subtotal === 0) return { subtotal: 0, serviceCharge: 0, tax: 0, corkage: 0, tip: 0, total: 0 };

            const beverageCount = cart.reduce((count, item) => item.category === 'beverage' ? count + item.quantity : count, 0);
            const corkage = beverageCount * CORKAGE_PER_BEV;
            const serviceCharge = Math.round(subtotal * 0.10);
            const tax = Math.round((subtotal + serviceCharge) * 0.18);
            const tip = tableGratuitySettings[tableId] ? Math.round(subtotal * 0.05) : 0;
            const total = subtotal + serviceCharge + tax + corkage + tip;

            return { subtotal, serviceCharge, tax, corkage, tip, total };
        }

        function placeOrder() {
            const itemsToOrder = tableOrders[currentTableId].filter(i => !i.sentToKitchen);
            if (itemsToOrder.length === 0) {
                showToast("Please add new items to current table", false);
                return;
            }

            const ticket = {
                id: Date.now(),
                table: currentTableId,
                items: itemsToOrder.map(i => ({ name: i.name, quantity: i.quantity })),
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' })
            };
            
            kitchenOrders.push(ticket);
            tableOrders[currentTableId].forEach(i => i.sentToKitchen = true);
            
            updateCartDisplay();
            showToast(`Order sent successfully for Table ${currentTableId}`, true);
        }

        function renderKitchen() {
            const grid = document.getElementById('kitchenOrdersGrid');
            grid.innerHTML = kitchenOrders.length === 0 ? `
                <div class="col-span-full flex flex-col items-center justify-center py-40 text-stone-400">
                    <svg class="w-24 h-24 mb-6 opacity-10" fill="currentColor" viewBox="0 0 24 24"><path d="M11 9H9V2H7V9H5V2H3V9C3 11.12 4.66 12.84 6.75 12.97V22H9.25V12.97C11.34 12.84 13 11.12 13 9V2H11V9ZM16 6V14H18.5V22H21V2C18.24 2 16 4.24 16 6Z"/></svg>
                    <p class="text-2xl font-serif italic uppercase tracking-[0.2em]">Kitchen is Clear</p>
                </div>` : '';
            
            kitchenOrders.forEach((order, index) => {
                grid.innerHTML += `
                    <div class="bg-white border-t-[6px] border-gold p-6 shadow-xl rounded-2xl relative">
                        <div class="flex justify-between items-start border-b border-stone-100 pb-4 mb-4">
                            <div>
                                <h4 class="font-bold text-3xl text-stone-900 tracking-tighter">Table ${order.table}</h4>
                                <div class="flex items-center gap-2 mt-1">
                                    <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                                    <span class="text-[10px] text-stone-500 uppercase tracking-widest font-bold">RECIEVED AT ${order.time}</span>
                                </div>
                            </div>
                        </div>
                        <ul class="space-y-3 mb-8 min-h-[150px]">
                            ${order.items.map(i => `
                                <li class="text-sm flex justify-between items-center bg-stone-50 p-3 rounded-lg border border-stone-100">
                                    <span class="font-medium text-stone-700">${i.name}</span>
                                    <span class="font-bold text-gold text-lg px-2">x${i.quantity}</span>
                                </li>`).join('')}
                        </ul>
                        <button onclick="clearKitchenOrder(${index})" class="w-full text-xs bg-stone-900 text-white py-4 rounded-xl hover:bg-gold hover:text-stone-900 uppercase font-bold tracking-[0.2em] transition-all shadow-lg active:scale-95">
                            Mark Prepared
                        </button>
                    </div>`;
            });
        }

        function clearKitchenOrder(index) {
            kitchenOrders.splice(index, 1);
            renderKitchen();
        }

        function renderManager() {
            const grid = document.getElementById('managerTableGrid');
            grid.innerHTML = '';
            let grandRev = 0;

            for (let i = 1; i <= 8; i++) {
                const billing = calculateBill(i);
                grandRev += billing.total;

                grid.innerHTML += `
                    <div class="bg-white p-8 rounded-3xl border-2 ${billing.total > 0 ? 'border-gold shadow-2xl scale-[1.02]' : 'border-stone-200 opacity-60'} transition-all">
                        <div class="flex justify-between items-center border-b border-stone-100 pb-4 mb-6">
                            <h4 class="font-bold text-2xl text-stone-800 tracking-tighter">Table ${i.toString().padStart(2, '0')}</h4>
                            <span class="${billing.total > 0 ? 'bg-green-100 text-green-700 border border-green-200' : 'bg-stone-100 text-stone-400 border border-stone-200'} text-[10px] px-3 py-1 rounded-full font-bold uppercase tracking-widest">
                                ${billing.total > 0 ? 'Occupied' : 'Vacant'}
                            </span>
                        </div>
                        <div class="space-y-3 mb-8">
                            <div class="flex justify-between text-xs text-stone-500 uppercase font-bold tracking-widest">
                                <span>Subtotal:</span> <span class="text-stone-900">₹${billing.subtotal.toLocaleString('en-IN')}</span>
                            </div>
                            <div class="flex justify-between text-xs text-stone-500 uppercase font-bold tracking-widest">
                                <span>Taxes & Service:</span> <span class="text-stone-900">₹${(billing.tax + billing.serviceCharge).toLocaleString('en-IN')}</span>
                            </div>
                            <div class="flex justify-between text-xs text-stone-500 uppercase font-bold tracking-widest">
                                <span>Gratuity:</span> <span class="text-gold">₹${billing.tip.toLocaleString('en-IN')}</span>
                            </div>
                            <div class="flex justify-between font-bold text-2xl text-stone-900 pt-4 mt-4 border-t-2 border-dashed border-stone-100">
                                <span class="font-serif">Net Due:</span> <span>₹${billing.total.toLocaleString('en-IN')}</span>
                            </div>
                        </div>
                        ${billing.total > 0 ? `
                            <button onclick="settleTable(${i})" class="w-full text-xs bg-stone-900 text-white py-4 rounded-xl hover:bg-gold hover:text-stone-900 transition-all uppercase font-bold tracking-[0.2em] shadow-lg">
                                Finalize Payment
                            </button>
                        ` : `
                            <div class="w-full text-center py-4 text-xs font-bold text-stone-300 uppercase tracking-widest border border-dashed border-stone-200 rounded-xl">Available</div>
                        `}
                    </div>`;
            }
            document.getElementById('totalRevenue').innerText = `₹ ${grandRev.toLocaleString('en-IN')}`;
        }

        window.settleTable = function(tableId) {
            tableOrders[tableId] = [];
            tableGratuitySettings[tableId] = false; 
            if (tableId === currentTableId) document.getElementById('gratuityToggle').checked = false;
            renderManager();
            showToast(`Table ${tableId} bill settled and finalized.`, false);
        }

        function showToast(msg, showKDSButton) {
            const toast = document.getElementById('toast');
            const action = document.getElementById('toastAction');
            document.getElementById('toastMsg').innerText = msg;
            
            if(showKDSButton) action.classList.remove('view-hidden');
            else action.classList.add('view-hidden');
            
            toast.classList.remove('opacity-0');
            toast.classList.add('opacity-100', 'translate-y-[-20px]');
            toast.style.pointerEvents = 'auto';
            
            setTimeout(() => {
                toast.classList.add('opacity-0');
                toast.classList.remove('opacity-100', 'translate-y-[-20px]');
                toast.style.pointerEvents = 'none';
            }, 4500);
        }

        window.onload = init;
    </script>
</body>
</html>